<app-header [isPrivate]="true">
  <div class="flex justify-between w-full">
    <button *ngIf="!edit" mat-button routerLink="/clientes">
      <mat-icon>arrow_back</mat-icon>
    </button>

    <button *ngIf="edit" mat-button (click)="edit = !edit">
      <mat-icon>close</mat-icon>
    </button>

    <button *ngIf="tabSelected == 0" mat-icon-button (click)="!edit ? (edit = !edit) : emitEventToChild()"
      class="icon-right" aria-label="Ediar cliente">
      <mat-icon *ngIf="!edit">edit</mat-icon>
      <mat-icon *ngIf="edit">check</mat-icon>
    </button>

    <button *ngIf="tabSelected == 1" mat-icon-button (click)="addSchedule()" class="icon-right"
      aria-label="Adicionar agendamento">
      <mat-icon>add_box</mat-icon>
    </button>

    <div *ngIf="tabSelected == 2">
      <button mat-button>
        <mat-icon>photo_camera</mat-icon>
      </button>
      <input type="file" (change)="inputFileChange($event)" class="input-photo" />
    </div>
  </div>

</app-header>


<div *ngIf="!loading" class="list">
  <mat-list *ngIf="!edit" @enter>
    <mat-list-item>
      <div class="flex w-full">
        <div mat-list-icon [style]="data?.nome || '' | iconColor" class="icon flex items-center justify-center">
          <span class="flex items-center justify-center">
            {{ data?.nome || '' | iconCustomer }}
          </span>
        </div>
        <div class="flex flex-col ml-4">
          <div mat-line>
            {{ data?.nome }}
          </div>
          <div mat-line>
            {{ data?.telefone1 || '' | formatPhone }}
          </div>
        </div>
      </div>

      <a href="tel:{{ data?.telefone1 }}" target="_blank">
        <button mat-icon-button aria-label="Telefone">
          <mat-icon style="color: black">phone</mat-icon>
        </button>
      </a>

      <a href="https://api.whatsapp.com/send?phone=55{{
            data?.telefone1
          }}text=Ol%C3%A1" target="_blank">
        <app-whatsapp-icon></app-whatsapp-icon>
      </a>
    </mat-list-item>
  </mat-list>

  <mat-tab-group mat-align-tabs="center" [selectedIndex]="tabSelected"
    (selectedIndexChange)="selectedIndexChange($event)">
    <mat-tab label="Dados">
      <div (swipe)="onSwipe($event)">
        <app-customer-complete-registration [data]="data" [edit]="edit" [events]="eventsSubject.asObservable()" />
      </div>
    </mat-tab>

    <mat-tab label="HistÃ³rico" *ngIf="!edit">
      <div (swipe)="onSwipe($event)" class="tab-container">
        <app-record-list *ngIf="records?.length" [data]="records"></app-record-list>
      </div>
    </mat-tab>

    <mat-tab label="Documentos" *ngIf="!edit">
      <div (swipe)="onSwipe($event)" class="tab-container">
        <div *ngIf="!photos?.length" style="text-align: center">
          Cadastre a primeira foto do cliente
        </div>
        <img *ngFor="let photo of photos" height="100px" src="{{ photo.url }}" />
      </div>
    </mat-tab>
  </mat-tab-group>
</div>